#!/bin/sh
DEV=$1
BAUD=${2:-115200}

CU=/usr/local/bin/cu
#CU=/usr/bin/cu

while true; do
  #
  # NOTE: cu src needs mofication to add --nortscts option
  # c.f. Debian bug: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=336996
  #
  if [ -z "`$CU --help | grep nortscts`" ]; then
      test -e $DEV && $CU -l $DEV -s $BAUD --parity=none --nostop dir
  else
      test -e $DEV && $CU -l $DEV -s $BAUD --parity=none --nostop --nortscts dir
  fi

  test $? -ne 0 && echo "ERROR during cu-loop execution";exit 1

  sleep 0.5
done
